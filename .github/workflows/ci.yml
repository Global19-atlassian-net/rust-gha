#############################################################
#   WARNING: automatically generated file, DO NOT CHANGE!   #
#############################################################

# This file was automatically generated by the expand-yaml-anchors tool. The
# source file that generated this one is:
#
#   src/ci/github-actions/ci.yml
#
# Once you make changes to that file you need to run:
#
#   ./x.py run src/tools/expand-yaml-anchors/
#
# The CI build will fail if the tool is not run after changes to this file.

---
name: CI
"on":
  push:
    branches:
      - auto
      - try
      - master
  pull_request:
    branches:
      - "**"
jobs:
  auto:
    name: auto
    env:
      CI_JOB_NAME: "${{ matrix.name }}"
      SCCACHE_BUCKET: rust-lang-gha-caches
      DEPLOY_BUCKET: rust-lang-gha
      TOOLSTATE_REPO: "https://github.com/pietroalbini/rust-toolstate"
      TOOLSTATE_ISSUES_API_URL: "https://api.github.com/repos/pietroalbini/rust-toolstate/issues"
      TOOLSTATE_PUBLISH: 1
      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZOMUQATD5
      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZH5AYXDVF
    if: "github.event_name == 'push' && github.ref == 'refs/heads/auto'"
    strategy:
      fail-fast: false
      matrix:
        name:
          - i686-msvc-2
        include:
          - name: i1686-msvc-2
            env:
              RUST_CONFIGURE_ARGS: "--build=i686-pc-windows-msvc"
              SCRIPT: make ci-subset-2
              NO_DEBUG_ASSERTIONS: 1
              NO_LLVM_ASSERTIONS: 1
            os: windows-latest-xl
    timeout-minutes: 600
    runs-on: "${{ matrix.os }}"
    steps:
      - name: configure GitHub Actions to kill the build when outdated
        uses: rust-lang/simpleinfra/github-actions/cancel-outdated-builds@master
        with:
          github_token: "${{ secrets.github_token }}"
      - name: disable git crlf conversion
        run: git config --global core.autocrlf false
        shell: bash
      - name: checkout the source code
        uses: actions/checkout@v1
        with:
          fetch-depth: 2
